<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>No vowels</title>
  <style>
    body { font-family: Arial, sans-serif; }
    .container { width: 100%; padding: 20px; box-sizing: border-box; font-size: 16px; }
    .title { font-size: 40px; font-weight: bold; text-align: center; margin-bottom: 20px; }
    .subtitle { font-size: 20px; margin-bottom: 10px; text-align: center; }
    .counter { font-size: 24px; font-weight: bold; text-align: center; margin-bottom: 10px; }
    .image-container { text-align: center; margin-bottom: 20px; }
    .image-container img { 
      width: 200px; 
      height: 200px; 
      object-fit: contain; 
      border-radius: 10px; 
      border: 2px solid #ccc; 
    }
    .sentence { margin-bottom: 20px; font-size: 20px; text-align: center; }
    .missing-word { width: 15px; padding: 0; font-size: 20px; border: none; border-bottom: 0.5px solid #000; background-color: transparent; outline: none; margin-right: 2px; text-align: center; }
    .correct { background-color: #cef4ce; }
    .incorrect { background-color: #ffb6c19c; }
    button { padding: 10px 20px; background-color: #f9f9f9; border: 2px solid #ccc; color: #000; border-radius: 10px; cursor: pointer; margin: 5px; }
    button:hover { background-color: #A9A9A9; transform: translateY(-4px); }
    .hide { display: none; }
    .feedback { font-weight: bold; font-size: 18px; text-align: center; margin-top: 10px; }
  </style>
</head>
<body onload="initializeExercise()">
  <div class="container">
    <div class="title">No vowels</div>
    <div class="subtitle">Fill in the sentence with the correct vowels.</div>
    <div class="counter" id="sentenceCounter"></div>
    <div id="exerciseOutput"></div>
    <div class="input-container">
      <div id="feedback" class="hide"></div>
      <button id="resetButton" class="hide" onclick="resetActivity()">Restart</button>
      <button id="nextButton" class="hide" onclick="nextText()">Next</button>
    </div>
  </div>

  <script>
    var currentTextIndex = 0;
    var sentencePairs = [];
    var lastFocusedInput = null;
    var vowels = ['a', 'e', 'i', 'o', 'u'];

    // English sentences
    var englishSentences = [
      "I wake up at seven o'clock.",
      "I had a shower in the morning.",
      "I went to work by car.",
      "I travel by car.",
      "I ate at the restaurant.",
      "I read a book in the evening.",
      "I write an email.",
      "I drink a cup of coffee.",
      "I watch TV at night.",
      "I listen to music."
    ];

    // Corresponding images (replace with your own GitHub links)
    var images = [
      "https://adaligand.github.io/EAL/School/Subjects/Images/Art.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Business.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Biology.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Chemistry.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Childdev.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Computing.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Drama.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/English.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/Food.png",
      "https://adaligand.github.io/EAL/School/Subjects/Images/French.png"
    ];

    function initializeExercise() {
      for (var i = 0; i < englishSentences.length; i++) {
        sentencePairs.push({ sentence: englishSentences[i], image: images[i] });
      }
      shuffleArray(sentencePairs);
      generateChunk();
    }

    function shuffleArray(array) {
      for (var i = array.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function generateChunk() {
      var sentence = sentencePairs[currentTextIndex].sentence;
      var sentenceWithInputFields = '';

      for (var i = 0; i < sentence.length; i++) {
        var char = sentence[i];
        if (vowels.includes(char.toLowerCase())) {
          sentenceWithInputFields += `<input type="text" class="missing-word" data-index="${i}" oninput="validateCharacter(this)" onfocus="setLastFocusedInput(this)" onkeydown="submitOnEnter(event, this)">`;
        } else {
          sentenceWithInputFields += char;
        }
      }

      var exerciseOutput = document.getElementById('exerciseOutput');
      exerciseOutput.innerHTML = '';

      var imageDiv = document.createElement('div');
      imageDiv.classList.add('image-container');
      imageDiv.innerHTML = `<img src="${sentencePairs[currentTextIndex].image}" alt="Exercise image">`;
      exerciseOutput.appendChild(imageDiv);

      var sentenceDiv = document.createElement('div');
      sentenceDiv.classList.add('sentence');
      sentenceDiv.innerHTML = sentenceWithInputFields;
      exerciseOutput.appendChild(sentenceDiv);

      document.getElementById('feedback').classList.add('hide');
      document.getElementById('resetButton').classList.add('hide');
      document.getElementById('nextButton').classList.add('hide');

      document.getElementById('sentenceCounter').textContent = (currentTextIndex + 1) + '/' + sentencePairs.length;

      var firstInput = exerciseOutput.querySelector('.missing-word');
      if (firstInput) firstInput.focus();
    }

    function setLastFocusedInput(input) {
      lastFocusedInput = input;
    }

    function validateCharacter(input) {
      var userInput = input.value.trim().toLowerCase();
      var correctChar = sentencePairs[currentTextIndex].sentence[input.getAttribute('data-index')];

      if (userInput === '') {
        input.classList.remove('correct', 'incorrect');
      } else if (userInput === correctChar.toLowerCase()) {
        input.classList.remove('incorrect');
        input.classList.add('correct');
      } else {
        input.classList.remove('correct');
        input.classList.add('incorrect');
      }

      // Move to next input after any letter
      if (userInput.length > 0) jumpToNextInput(input);

      checkAnswers();
    }

    function jumpToNextInput(input) {
      var nextInput = input.nextElementSibling;
      while (nextInput && !nextInput.classList.contains('missing-word')) {
        nextInput = nextInput.nextElementSibling;
      }
      if (nextInput) nextInput.focus();
    }

    function jumpToPreviousInput(input) {
      var prevInput = input.previousElementSibling;
      while (prevInput && !prevInput.classList.contains('missing-word')) {
        prevInput = prevInput.previousElementSibling;
      }
      if (prevInput) {
        prevInput.focus();
        prevInput.value = '';
        prevInput.classList.remove('correct', 'incorrect');
      }
    }

    document.addEventListener('keydown', function(event) {
      var active = document.activeElement;
      if (active && active.classList.contains('missing-word')) {
        if (event.key === 'Backspace' && active.value === '') {
          event.preventDefault();
          jumpToPreviousInput(active);
        }
      }
    });

    function submitOnEnter(event, input) {
      if (event.keyCode === 13) {
        jumpToNextInput(input);
        event.preventDefault();
      }
    }

    function checkAnswers() {
      var inputFields = document.querySelectorAll('.missing-word');
      var allCorrect = true;
      inputFields.forEach(function(input) {
        if (!input.classList.contains('correct')) allCorrect = false;
      });
      if (allCorrect) {
        if (currentTextIndex === sentencePairs.length - 1) {
          document.getElementById('resetButton').classList.remove('hide');
        } else {
          document.getElementById('nextButton').classList.remove('hide');
        }
      }
    }

    function nextText() {
      currentTextIndex = (currentTextIndex + 1) % sentencePairs.length;
      if (currentTextIndex === 0) {
        resetActivity();
      } else {
        generateChunk();
      }
    }

    function resetActivity() {
      currentTextIndex = 0;
      shuffleArray(sentencePairs);
      generateChunk();
    }
  </script>
</body>
</html>
